<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ipopt: Installing Ipopt</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ipopt Documentation
   &#160;<!--span id="projectnumber">trunk</span-->
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('INSTALL.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Installing Ipopt </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#SYSTEMPACKAGES">Getting System Packages (Compilers, ...)</a></li>
<li class="level1"><a href="#GETIPOPT">Getting the Ipopt Code</a></li>
<li class="level1"><a href="#GETIPOPT_GIT">Getting the Ipopt code via git</a></li>
<li class="level1"><a href="#GETIPOPT_TAR">Getting the Ipopt code as a tarball</a></li>
<li class="level1"><a href="#EXTERNALCODE">Download External Code</a><ul><li class="level2"><a href="#DOWNLOAD_LINALGASL">Download BLAS, LAPACK and ASL</a></li>
<li class="level2"><a href="#DOWNLOAD_HSL">Download HSL Subroutines</a></li>
<li class="level2"><a href="#DOWNLOAD_MUMPS">Obtaining the MUMPS Linear Solver</a></li>
<li class="level2"><a href="#DOWNLOAD_PARDISO">Obtaining the Linear Solver Pardiso</a></li>
<li class="level2"><a href="#DOWNLOAD_WSMP">Obtaining the Linear Solver WSMP</a></li>
<li class="level2"><a href="#LINEARSOLVERLOADER">Using the Linear Solver Loader</a></li>
<li class="level2"><a href="#DOWNLOAD_METIS">Obtaining METIS</a></li>
</ul>
</li>
<li class="level1"><a href="#COMPILEINSTALL">Compiling and Installing Ipopt</a></li>
<li class="level1"><a href="#INSTALL_WINDOWS">Installation on Windows</a><ul><li class="level2"><a href="#INSTALL_CYGWIN">Installation with Cygwin using GNU compilers</a></li>
<li class="level2"><a href="#INSTALL_CYGWINNATIVE">Installation with Cygwin using the MSVC++ compiler</a></li>
<li class="level2"><a href="#INSTALL_MINGW">Installation with MSYS/MinGW</a></li>
</ul>
</li>
<li class="level1"><a href="#INSTALL_JAVA">Compiling and Installing the Java Interface JIpopt</a></li>
<li class="level1"><a href="#INSTALL_R">Compiling and Installing the R Interface ipoptr</a></li>
<li class="level1"><a href="#INSTALL_MATLAB">Compiling and Installing the MATLAB interface</a><ul><li class="level2"><a href="#INSTALL_MATLAB_MEX">Setting up mex</a></li>
<li class="level2"><a href="#INSTALL_MATLAB_IPOPT">Adjusting configuration and build of Ipopt</a></li>
<li class="level2"><a href="#INSTALL_MATLAB_BUILD">Building the MATLAB interface</a></li>
<li class="level2"><a href="#INSTALL_MATLAB_ADDPATH">Making MATLAB aware of the mex file</a></li>
<li class="level2"><a href="#INSTALL_MATLAB_NOTES">Additional notes</a></li>
<li class="level2"><a href="#INSTALL_MATLAB_TROUBLESHOOT">Troubleshooting</a></li>
</ul>
</li>
<li class="level1"><a href="#EXPERT_INSTALL">Expert Installation Options for Ipopt</a></li>
</ul>
</div>
<div class="textblock"><p>The following sections describe the installation procedures on UNIX/Linux systems.</p>
<p>For installation instructions on Windows see <a class="el" href="INSTALL.html#INSTALL_WINDOWS">Installation on Windows</a>.</p>
<p>Additional hints on installing <code>Ipopt</code> and its various interfaces is available on the <code>Ipopt</code> and CoinHelp wiki pages, in particular</p>
<ul>
<li><code>Ipopt</code> compilation hints: <a href="https://github.com/coin-or/Ipopt/wiki/CompilationHints">https://github.com/coin-or/Ipopt/wiki/CompilationHints</a></li>
<li>Current configuration and installation issues for COIN-OR projects: <a href="https://projects.coin-or.org/BuildTools/wiki/current-issues">https://projects.coin-or.org/BuildTools/wiki/current-issues</a></li>
</ul>
<h1><a class="anchor" id="SYSTEMPACKAGES"></a>
Getting System Packages (Compilers, ...)</h1>
<p>Many Linux distributions will come with all necessary tools. All you should need to do is check the compiler versions. On a Debian-based distribution, you can obtain all necessary tools with the following command: </p><pre class="fragment">sudo apt-get install gcc g++ gfortran git patch wget
</pre><p>Replace apt-get with your relevant package manager, e.g. yum for Red Hat-based distributions, zypper for SUSE, etc. The g++ and gfortran compilers may need to be specified respectively as gcc-c++ and gcc-gfortran with some package managers.</p>
<p>On Mac OS X, you need either the <a href="https://developer.apple.com/downloads">Xcode Command Line Tools</a> or a community alternative such as <a href="https://github.com/kennethreitz/osx-gcc-installer">https://github.com/kennethreitz/osx-gcc-installer</a> to install the gcc and g++ compilers. It has been reported, that gcc/g++ 4.2 and older is not sufficient for using the HSL codes. If you have a recent version of Xcode installed, the Command Line Tools are available under Preferences, Downloads. In Xcode 3.x, the Command Line Tools are contained in the optional item "UNIX Dev Support" during Xcode installation. These items unfortunately do not come with a Fortran compiler, but you can get gfortran from <a href="http://gcc.gnu.org/wiki/GFortranBinaries#MacOS">http://gcc.gnu.org/wiki/GFortranBinaries#MacOS</a>. We have been able to compile <code>Ipopt</code> using default Xcode versions of gcc and g++ and a newer version of gfortran from this link, but consistent version numbers may be an issue in future cases.</p>
<h1><a class="anchor" id="GETIPOPT"></a>
Getting the Ipopt Code</h1>
<p><code>Ipopt</code> is available from the COIN-OR group at GitHub. You can either download the code using <code>git</code> or simply retrieve a tarball (compressed archive file). While the tarball is an easy method to retrieve the code, using the <em>git</em> system allows users the benefits of the version control system, including easy updates and revision control.</p>
<h1><a class="anchor" id="GETIPOPT_GIT"></a>
Getting the Ipopt code via git</h1>
<p>Of course, the <em>git</em> client must be installed on your system if you want to obtain the code this way (the executable is called <code>git</code>). Information about <em>git</em> and how to download it can be found at <a href="http://git-scm.com">http://git-scm.com</a>.</p>
<p>To obtain the <code>Ipopt</code> source code via git, change into the directory in which you want to create a subdirectory CoinIpopt with the <code>Ipopt</code> source code. Then follow the steps below:</p>
<ol type="1">
<li>Download the code from the repository: <pre class="fragment">git clone --recursive -b stable/3.12 https://github.com/coin-or/Ipopt.git CoinIpopt</pre></li>
<li>Change into the root directory of the <code>Ipopt</code> distribution:<pre class="fragment">cd CoinIpopt</pre></li>
</ol>
<p>In the following, <code>$IPOPTDIR</code> will refer to the directory in which you are right now (output of <code>pwd</code>).</p>
<h1><a class="anchor" id="GETIPOPT_TAR"></a>
Getting the Ipopt code as a tarball</h1>
<p>To use the tarball, follow the steps below:</p>
<ol type="1">
<li>Download the desired tarball from <a href="http://www.coin-or.org/download/source/Ipopt">http://www.coin-or.org/download/source/Ipopt</a>, it has the form <code>Ipopt-x.y.z.tgz</code>, where <code>x.y.z</code> is the version number, such as 3.12.0.</li>
<li>Issue the following commands to unpack the archive file: <pre class="fragment">gunzip Ipopt-x.y.z.tgz
tar xvf Ipopt-x.y.z.tar</pre></li>
<li>Rename the directory you just extracted:<pre class="fragment">mv Ipopt-x.y.z CoinIpopt</pre></li>
<li>Change into the root directory of the <code>Ipopt</code> distribution:<pre class="fragment">cd CoinIpopt</pre></li>
</ol>
<p>In the following, <code>$IPOPTDIR</code> will refer to the directory in which you are right now (output of <code>pwd</code>).</p>
<h1><a class="anchor" id="EXTERNALCODE"></a>
Download External Code</h1>
<p><code>Ipopt</code> uses a few external packages that are not included in the <code>Ipopt</code> source code distribution, namely ASL (the AMPL Solver Library if you want to compile the <code>Ipopt</code> AMPL solver executable), Blas, Lapack.</p>
<p><code>Ipopt</code> also requires at least one linear solver for sparse symmetric indefinite matrices. There are different possibilities, see below. <b>It is important to keep in mind that usually the largest fraction of computation time in the optimizer is spent for solving the linear system, and that your choice of the linear solver impacts <code>Ipopt</code>'s speed and robustness. It might be worthwhile to try different linear solver to experiment with what is best for your application.</b></p>
<p>Since this third party software is released under different licenses than <code>Ipopt</code>, we cannot distribute their code together with the <code>Ipopt</code> packages and have to ask you to go through the hassle of obtaining it yourself (even though we tried to make it as easy for you as we could). Keep in mind that it is still your responsibility to ensure that your downloading and usage of the third party components conforms with their licenses.</p>
<p>Note that you only need to obtain the ASL if you intend to use <code>Ipopt</code> from AMPL. It is not required if you want to specify your optimization problem in a programming language (C++, C, or Fortran). Also, currently, Lapack is only required if you intend to use the quasi-Newton options implemented in <code>Ipopt</code>.</p>
<h2><a class="anchor" id="DOWNLOAD_LINALGASL"></a>
Download BLAS, LAPACK and ASL</h2>
<p>Note: It is <b>highly recommended that you obtain an efficient implementation of the BLAS library</b>, tailored to your hardware; Section <a class="el" href="index.html#PREREQUISITES">Prerequisites</a> lists a few options. Assuming that your precompiled efficient BLAS library is <code>libmyblas.a</code> in <code>$HOME/lib</code>, you need to add the flag <code>--with-blas="-L$HOME/lib -lmyblas"</code> when you run <code>configure</code> (see <a class="el" href="INSTALL.html#COMPILEINSTALL">Compiling and Installing Ipopt</a>). Some of those libraries also include LAPACK.</p>
<p>If you have the download utility <code>wget</code> installed on your system (or <code>ftp</code> on Mac OS X, or <code>curl</code>), retrieving source code for BLAS (the inefficient reference implementation, not required if you have a precompiled library), as well as LAPACK and ASL is straightforward using scripts included with the ipopt distribution. These scripts download the required files from the <a href="http://www.netlib.org">Netlib Repository</a>.</p>
<pre class="fragment">cd $IPOPTDIR/ThirdParty/Blas
./get.Blas
cd $IPOPTDIR/ThirdParty/Lapack
./get.Lapack
cd $IPOPTDIR/ThirdParty/ASL
./get.ASL
</pre><p>If you do not have <code>wget</code> (or <code>ftp</code> on Mac OS X or <code>curl</code>) installed on your system, please read the <code>INSTALL.*</code> files in the <code>$IPOPTDIR/ThirdParty/Blas</code>, <code>$IPOPTDIR/ThirdParty/Lapack</code> and <code>$IPOPTDIR/ThirdParty/ASL</code> directories for alternative instructions.</p>
<p>If you are having firewall issues with <code>wget</code>, try opening the <code>get.&lt;library&gt;</code> scripts and replace the line <code>wgetcmd=wget</code> with <code>wgetcmd="wget --passive-ftp"</code>.</p>
<p>If you are getting permissions errors from <code>tar</code>, try opening the <code>get.&lt;library&gt;</code> scripts and replace any instances of <code>tar xf</code> with <code>tar --no-same-owner -xf</code>.</p>
<h2><a class="anchor" id="DOWNLOAD_HSL"></a>
Download HSL Subroutines</h2>
<p>There are two versions of HSL available:</p>
<ul>
<li>HSL Archive: contains outdated codes that are freely available for personal commercial or non-commercial usage. Note that you may not redistribute these codes in either source or binary form without purchasing a licence from the authors. This version includes MA27, MA28, and MC19.</li>
<li>HSL 2011: contains more modern codes that are freely available for academic use only. This version includes the codes from the HSL Archive and additionally MA57, HSL_MA77, HSL_MA86, and HSL_MA97. <code>Ipopt</code> supports the HSL 2011 codes from 2012 and 2013, the support for the versions from 2012 may be dropped in a future release.</li>
</ul>
<p>To obtain the HSL code, you can follow the following steps:</p>
<ol type="1">
<li>Go to <a href="http://hsl.rl.ac.uk/ipopt">http://hsl.rl.ac.uk/ipopt</a>.</li>
<li>Choose whether to download either the Archive code or the HSL 2011 code. To download, select the relevant "source" link.</li>
<li>Follow the instructions on the website, read the license, and submit the registration form.</li>
<li>Wait for an email containing a download link (this should take no more than one working day).</li>
</ol>
<p>You may either:</p>
<ul>
<li>Compile the HSL code as part of <code>Ipopt</code>. See the instructions below.</li>
<li>Compile the HSL code separately either before or after the <code>Ipopt</code> code and use the shared library loading mechanism. See the documentation distributed with the HSL package for information on how to do so.</li>
</ul>
<p>To compile the HSL code as part of <code>Ipopt</code>, unpack the archive, then move and rename the resulting directory so that it becomes <code>$IPOPTDIR/ThirdParty/HSL/coinhsl</code>. <code>Ipopt</code> may then be configured as normal.</p>
<p>Note: Whereas it is essential to have at least one linear solver, the package MC19 could be omitted (with the consequence that you cannot use this method for scaling the linear systems arising inside the <code>Ipopt</code> algorithm). By default, MC19 is only used to scale the linear system when using one of the HSL solvers, but it can also be switched on for other linear solvers (which usually have internal scaling mechanisms). Further, also the package MA28 can be omitted, since it is used only in the experimental dependency detector, which is not used by default.</p>
<p>Note: If you are an academic or a student, we recommend you download the HSL 2011 package as this ensures you have access to the full range of solvers. MA57 can be considerably faster than MA27 on some problems.</p>
<p>Yet another note: If you have a precompiled library containing the HSL codes, you can specify the directory with the header files and the linker flags for this library with the <code>--with-hsl-incdir</code> and <code>--with-hsl-lib</code> flags for the configure script described in <a class="el" href="INSTALL.html#COMPILEINSTALL">Compiling and Installing Ipopt</a>.</p>
<h2><a class="anchor" id="DOWNLOAD_MUMPS"></a>
Obtaining the MUMPS Linear Solver</h2>
<p>You can also use the (public domain) sparse linear solver MUMPS. Please visit the <a href="http://graal.ens-lyon.fr/MUMPS">MUMPS home page</a> for more information about the solver. MUMPS is provided as Fortran 90 and C source code. You need to have a Fortran 90 compiler (for example, the GNU compiler gfortran is a free one) to be able to use it.</p>
<p>You can obtain the MUMPS code by running the script <code>$IPOPTDIR/ThirdParty/Mumps/get.Mumps</code> if you have <code>wget</code> (or <code>ftp</code> on Mac OS X or <code>curl</code>) installed in your system. Alternatively, you can get MUMPS 4.10 from the MUMPS home page and extract the archive in the directory <code>$IPOPTDIR/ThirdParty/Mumps</code>. The extracted directory usually has the MUMPS version number in it, so you need to rename it to MUMPS such that you have a file called <code>$IPOPTDIR/ThirdParty/Mumps/MUMPS/README</code>.</p>
<p>Once you put the MUMPS source code into the correct place, the <code>Ipopt</code> configuration scripts will automatically detect it and compile MUMPS together with <code>Ipopt</code>, <em>if your Fortran compiler is able to compile Fortran 90 code</em>.</p>
<p>Note: MUMPS will perform better with METIS, see <a class="el" href="INSTALL.html#DOWNLOAD_METIS">Obtaining METIS</a>.</p>
<p>Note: MUMPS uses interally a fake implementation of MPI. If you are using <code>Ipopt</code> within an MPI program together with MUMPS, the code will not run. You will have to modify the MUMPS sources so that the MPI symbols inside the MUMPS code are renamed.</p>
<h2><a class="anchor" id="DOWNLOAD_PARDISO"></a>
Obtaining the Linear Solver Pardiso</h2>
<p>If you would like to compile <code>Ipopt</code> with the Parallel Sparse Direct Linear Solver (Pardiso), you need to obtain either Intel's MKL library or the Pardiso library from <a href="http://www.pardiso-project.org">http://www.pardiso-project.org</a> for your operating system.</p>
<p>From <a href="http://www.pardiso-project.org">http://www.pardiso-project.org</a>, you can obtain a limited time license of Pardiso for academic or evaluation purposes or buy a non-profit or commercial license. Make sure you read the license agreement before filling out the download form.</p>
<p>Please consult <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a> to find out how to configure your <code>Ipopt</code> installation to work with Pardiso.</p>
<h2><a class="anchor" id="DOWNLOAD_WSMP"></a>
Obtaining the Linear Solver WSMP</h2>
<p>If you would like to compile <code>Ipopt</code> with the Watson Sparse Matrix Package (WSMP), you need to obtain the WSMP library for your operating system. Information about WSMP can be found at <a href="http://www.research.ibm.com/projects/wsmp">http://www.research.ibm.com/projects/wsmp</a>.</p>
<p>At this website you can download the library for several operating systems including a trial license key for 90 days that allows you to use WSMP for "educational, research, and benchmarking purposes by non-profit
academic institutions" or evaluation purposes by commercial organizations; make sure you read the license agreement before using the library. Once you obtained the library and license, please check if the version number of the library matches the one on the WSMP website.</p>
<p>If a newer version is announced on that website, you can (and probably should) request the current version by sending a message to <code>wsmp@watson.ibm.com</code>. Please include the operating system and other details to describe which particular version of WSMP you need.</p>
<p>Note: Only the interface to the shared-memory version of WSMP is currently supported.</p>
<p>Please consult <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a> to find out how to configure your <code>Ipopt</code> installation to work with WSMP.</p>
<h2><a class="anchor" id="LINEARSOLVERLOADER"></a>
Using the Linear Solver Loader</h2>
<p>By default, <code>Ipopt</code> will be compiled with a mechanism, the Linear Solver Loader, which can dynamically load shared libraries with MA27, MA57, HSL_MA77, HSL_MA86, HSL_MA97, or the Pardiso linear solver at runtime.</p>
<p>This means, if you obtain one of those solvers after you compiled <code>Ipopt</code>, you don't need to recompile to use it. Instead, you can just put a shared library called <code>libhsl.so</code> or <code>libpardiso.so</code> into the shared library search path, <code>LD_LIBRARY_PATH</code>. These are the names on most UNIX platforms, including Linux. On Mac OS X, the names are <code>libhsl.dylib</code>, <code>libpardiso.dylib</code>, and <code>DYLD_LIBRARY_PATH</code>. On Windows, the names are <code>libhsl.dll</code>, <code>libpardiso.dll</code>, and <code>PATH</code>.</p>
<p>The Pardiso shared library can be downloaded from the Pardiso website. To create a shared library containing the HSL linear solvers, read the instructions in <code>$IPOPTDIR/ThirdParty/HSL/INSTALL.HSL</code>.</p>
<p>The Linear Solver Loader is not enabled if you compile <code>Ipopt</code> with the MS Visual Studio project files provided in the <code>Ipopt</code> distribution. Further, if you have problems compiling this feature, you can disable this by specifying <code>--disable-linear-solver-loader</code> for the <code>configure</code> script.</p>
<h2><a class="anchor" id="DOWNLOAD_METIS"></a>
Obtaining METIS</h2>
<p>The linear solvers MA57, HSL_MA77, HSL_MA86, HSL_MA97, and MUMPS can make use of the matrix ordering algorithms implemented in <a href="http://glaros.dtc.umn.edu/gkhome/metis/metis/overview">METIS</a>. If you are using one of these linear solvers, you should obtain the METIS source code and put it into <code>$IPOPTDIR/ThirdParty/Metis</code>. Read the <code>INSTALL.Metis</code> file in that directory, and if you have the <code>wget</code> utility (or <code>ftp</code> on Mac OS X or <code>curl</code>) installed on your system, you can download the code by running the <code>./get.Metis</code> script.</p>
<p>Note, that <b>only the older <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/OLD/metis-4.0.3.tar.gz">METIS 4.x version</a> is supported</b> by MA57, HSL_MA77, HSL_MA86, HSL_MA97, MUMPS, and the build system. The <code>./get.Metis</code> script takes care of downloading the right METIS version.</p>
<h1><a class="anchor" id="COMPILEINSTALL"></a>
Compiling and Installing Ipopt</h1>
<p><code>Ipopt</code> can be easily compiled and installed with the usual configure, make, make install commands. We follow the procedure that is used for most of the COIN-OR projects, based on the GNU autotools. At <a href="https://projects.coin-or.org/CoinHelp">https://projects.coin-or.org/CoinHelp</a> you can find a general description of the tools.</p>
<p>Below are the basic steps for the <code>Ipopt</code> compilation that should work on most systems. For special compilations and for some troubleshooting see <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a> and consult the <a href="https://projects.coin-or.org/CoinHelp">generic COIN-OR help page</a> before creating an issue or sending a message to the mailing list.</p>
<ol type="1">
<li><p class="startli">Create a directory where you want to compile <code>Ipopt</code>, for example </p><pre class="fragment">mkdir $IPOPTDIR/build</pre><p> and change into this directory </p><pre class="fragment">cd $IPOPTDIR/build</pre><p class="startli">Note: You can choose any location, including $IPOPTDIR itself, as the location of your compilation. However, on COIN-OR we recommend to keep the source and compiled files separate.</p>
</li>
<li><p class="startli">Run the configure script: </p><pre class="fragment">$IPOPTDIR/configure</pre><p class="startli">One might have to give options to the configure script, e.g., in order to choose a non-default compiler, or to tell it where some third party code is installed, see <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a>.</p>
<p class="startli">If the last output line reads <code>configure: Main configuration of <a class="el" href="namespaceIpopt.html" title="This file contains a base class for all exceptions and a set of macros to help with exceptions...">Ipopt</a> successful</code> then everything worked fine. Otherwise, look at the screen output, have a look at the <code>config.log</code> output files and/or consult <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a>.</p>
<p class="startli">The default configure (without any options) is sufficient for most users that downloaded the source code for the linear solver. If you want to see the configure options, consult <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a> and also visit the generic <a href="https://projects.coin-or.org/CoinHelp/wiki/user-configure">COIN-OR configuration instruction page</a>.</p>
</li>
<li><p class="startli">Build the code: </p><pre class="fragment">make</pre><p class="startli">Note: If you are using GNU make, you can also try to speed up the compilation by using the <code>-jN</code> flag (e.g., <code>make -j3</code>), where <code>N</code> is the number of parallel compilation jobs. A good number for <code>N</code> is the number of available processors plus one. Under some circumstances, this fails, and you might have to re-issue the command, or omit the <code>-j</code> flag.</p>
</li>
<li><p class="startli">If you want, you can run a short test to verify that the compilation was successful. For this, you just enter </p><pre class="fragment">make test</pre><p> This will test if the AMPL solver executable works (if you got the ASL code) and if the included C++, C, and Fortran examples work.</p>
<p class="startli">Note: The configure script is not able to automatically determine the C++ runtime libraries for the C++ compiler. For certain compilers we enabled default values for this, but those might not exist or be wrong for your compiler. In that case, the C and Fortran example in the test will most probably fail to compile. If you don't want to hook up the compiled <code>Ipopt</code> library to some Fortran or C code that you wrote you don't need to worry about this. If you do want to link the <code>Ipopt</code> library with a C or Fortran compiler, you need to find out the C++ runtime libraries (e.g., by running the C++ compiler in verbose mode for a simple example program) and run <code>configure</code> again, and this time specify all C++ runtime libraries with the <code>CXXLIBS</code> variable (see also <a class="el" href="INSTALL.html#EXPERT_INSTALL">Expert Installation Options for Ipopt</a>).</p>
</li>
<li><p class="startli">Install <code>Ipopt</code>: </p><pre class="fragment">make install</pre><p> This installs</p><ul>
<li>the <code>Ipopt</code> AMPL solver executable (if ASL source was downloaded) in <code>$IPOPTDIR/build/bin</code>,</li>
<li>the <code>Ipopt</code> library (<code>libipopt.so</code>, <code>libipopt.a</code> or similar) and all its dependencies (MUMPS, HSL, Metis libraries) in <code>$IPOPTDIR/build/lib</code>,</li>
<li>text files <code>ipopt_addlibs_cpp.txt</code>, <code>ipopt_addlibs_c.txt</code>, and <code>ipopt_addlibs_f.txt</code> in <code>$IPOPTDIR/build/share/coin/doc/Ipopt</code>, each containing a line with linking flags that are required for linking code with the <code>Ipopt</code> library for C++, C, and Fortran main programs, respectively. (This is only for convenience if you want to find out what additional flags are required, for example, to include the Fortran runtime libraries with a C++ compiler.)</li>
<li>the necessary header files in <code>$IPOPTDIR/build/include/coin</code>.</li>
</ul>
<p class="startli">You can change the default installation directory (here <code>$IPOPTDIR/build</code>) to something else (such as <code>/usr/local</code>) by using the <code>--prefix</code> switch for <code>configure</code>.</p>
</li>
<li>(Optional) Install <code>Ipopt</code> for use with CUTEr: If you have CUTEr already installed on your system and you want to use <code>Ipopt</code> as a solver for problems modeled in SIF, type <pre class="fragment">make cuter</pre> This assumes that you have the environment variable <code>MYCUTER</code> defined according to the CUTEr instructions. After this, you can use the script <code>sdipo</code> as the CUTEr script to solve a SIF model.</li>
</ol>
<p>Note: The above procedures show how to compile the code in directories separate from the source files. This comes in handy when you want to compile the code with different compilers, compiler options, or different operating system that share a common file system. To use this feature, change into the directory where you want to compile the code, and then type <code>$IPOPTDIR/configure</code> with all the options. For this, the directories with the <code>Ipopt</code> source must not have any configuration and compiled code.</p>
<h1><a class="anchor" id="INSTALL_WINDOWS"></a>
Installation on Windows</h1>
<p>There are several ways to install <code>Ipopt</code> on Windows systems. The first two options, described in <a class="el" href="INSTALL.html#INSTALL_CYGWIN">Installation with Cygwin using GNU compilers</a> and <a class="el" href="INSTALL.html#INSTALL_CYGWINNATIVE">Installation with Cygwin using the MSVC++ compiler</a>, are to use <a href="http://www.cygwin.com">Cygwin</a>, which offers a comprehensive UNIX-like environment on Windows and in which the installation procedure described earlier in this section can be used. If you want to use the (free) GNU compilers, follow the instructions in <a class="el" href="INSTALL.html#INSTALL_CYGWIN">Installation with Cygwin using GNU compilers</a>. If you have the Microsoft C++ compiler and possibly a "native" Fortran compiler (e.g., the Intel Fortran compiler) and want to use those to compile <code>Ipopt</code>, please see <a class="el" href="INSTALL.html#INSTALL_CYGWINNATIVE">Installation with Cygwin using the MSVC++ compiler</a>. If you use MSYS/MinGW (a light-weight UNIX-like environment for Windows), please consider the notes in <a class="el" href="INSTALL.html#INSTALL_MINGW">Installation with MSYS/MinGW</a>. If you want to compile the <code>Ipopt</code> mex interface to MATLAB, then we recommend to use the MSYS/MinGW option.</p>
<p>Note: Some binaries for <code>Ipopt</code> are available on the COIN-OR website at <a href="http://www.coin-or.org/download/binary/Ipopt">http://www.coin-or.org/download/binary/Ipopt</a>. There, also precompiled versions of <code>Ipopt</code> as DLLs (generated from the MSVS solution in <code>Ipopt</code>'s subdirectory <code>$IPOPTDIR/Ipopt/MSVisualStudio/v8-ifort</code>) are available. Look at the <code>README</code> files for details. An example how to use these DLLs from your own MSVS project is in <code>$IPOPTDIR/Ipopt/MSVisualStudio/BinaryDLL-Link-Example</code>.</p>
<h2><a class="anchor" id="INSTALL_CYGWIN"></a>
Installation with Cygwin using GNU compilers</h2>
<p>Cygwin is a Linux-like environment for Windows; if you don't know what it is you might want to have a look at the <a href="http://www.cygwin.com">Cygwin homepage</a>.</p>
<p>It is possible to build the <code>Ipopt</code> AMPL solver executable in Cygwin for general use in Windows. You can also hook up <code>Ipopt</code> to your own program if you compile it in the Cygwin environment. (It is also possible to build an <code>Ipopt</code> DLL that can be used from non-cygwin compilers, but this is not (yet?) supported.)</p>
<p>If you want to compile <code>Ipopt</code> under Cygwin, you first have to install Cygwin on your Windows system. This is pretty straight forward; you simply download the "setup" program from <a href="http://www.cygwin.com">http://www.cygwin.com</a> and start it.</p>
<p>Then you do the following steps (assuming here that you don't have any complications with firewall settings etc - in that case you might have to choose some connection settings differently):</p>
<ol type="1">
<li>Click next</li>
<li>Select "install from the internet" (default) and click next</li>
<li>Select a directory where Cygwin is to be installed (you can leave the default) and choose all other things to your liking, then click next</li>
<li>Select a temp dir for Cygwin setup to store some files (if you put it on your desktop you will later remember to delete it)</li>
<li>Select "direct connection" (default) and click next</li>
<li>Select some mirror site that seems close by to you and click next</li>
<li><p class="startli">OK, now comes the complicated part: You need to select the packages that you want to have installed. By default, there are already selections, but the compilers are usually not pre-chosen. You need to make sure that you select the GNU compilers (for Fortran, C, and C++), Git, and some additional tools. For this, get the following packages from the associated branches:</p><ul>
<li>"Devel": gcc4</li>
<li>"Devel": gcc4-fortran</li>
<li>"Devel": pkg-config</li>
<li>"Devel": subversion</li>
<li>"Archive": unzip</li>
<li>"Utils": patch</li>
<li>"Web": wget</li>
</ul>
<p class="startli">When a Resolving Dependencies window comes up, be sure to "Select
    required packages (RECOMMENDED)". This will automatically also select some other packages.</p>
</li>
<li>Then you click on next, and Cygwin will be installed (follow the rest of the instructions and choose everything else to your liking). At a later point you can easily add/remove packages with the setup program.</li>
<li>The version of the GNU Make utility provided by the Cygwin installer will not work. Therefore, you need to download the fixed version from <a href="http://www.cmake.org/files/cygwin/make.exe">http://www.cmake.org/files/cygwin/make.exe</a> and save it to <code>C:\cygwin\bin</code>. Double-check this new version by typing <code>make --version</code> in a Cygwin terminal (see next point). If you get an error <code>-bash: /usr/bin/make: Bad address</code>, then try <a href="http://www.cmake.org/files/cygwin/make.exe-cygwin1.7">http://www.cmake.org/files/cygwin/make.exe-cygwin1.7</a> instead, rename it to make.exe and move it to <code>C:\cygwin\bin</code>. (Replace <code>C:\cygwin</code> with your installation location if different.)</li>
<li>Now that you have Cygwin, you can open a Cygwin window, which is like a UNIX shell window.</li>
<li>Now you just follow the instructions in the beginning of <a class="el" href="INSTALL.html">Installing Ipopt</a> : You download the <code>Ipopt</code> code into your Cygwin home directory (from the Windows explorer that is usually something like <code>C:\Cygwin\home\your_user_name</code>). After that you obtain the third party code (as on Linux/UNIX), type <pre class="fragment">./configure
make install</pre> in the correct directories, and hopefully that will work. The <code>Ipopt</code> AMPL solver executable will be in the subdirectory <code>bin</code> (called <code>ipopt.exe</code>). If you want to test the installation, type <pre class="fragment">make test</pre></li>
</ol>
<h2><a class="anchor" id="INSTALL_CYGWINNATIVE"></a>
Installation with Cygwin using the MSVC++ compiler</h2>
<p>This section describes how you can compile <code>Ipopt</code> with the Microsoft Visual C++ compiler under Cygwin. Here you have two options for compiling the Fortran code in the third party dependencies:</p>
<ul>
<li>Using a Windows Fortran compiler, e.g., the Intel Fortran compiler, which is also able to compile Fortran 90 code. This would allow you to compile the MUMPS linear solver if you desire to do so.</li>
<li>Using the f2c Fortran to C compiler, available for free at Netlib (see <a href="http://www.netlib.org/f2c">http://www.netlib.org/f2c</a>). This can only compile Fortran 77 code (i.e., you won't be able to compile MUMPS). Before doing the following installation steps, you need to follow the instructions in <code>$IPOPTDIR/BuildTools/compile_f2c/INSTALL</code>.</li>
</ul>
<p>Once you have settled on this, do the following:</p>
<ol type="1">
<li>Follow the instructions in <a class="el" href="INSTALL.html#INSTALL_CYGWIN">Installation with Cygwin using GNU compilers</a> until Step 11 and stop after your downloaded the third party code.</li>
<li><p class="startli">Now you need to make sure that Cygwin knows about the native compilers. For this you need to edit the file <code>cygwin.bat</code> in the Cygwin base directory (usually <code>C:\cygwin</code>). Here you need to add a line like the following: </p><pre class="fragment">call "C:\Program Files\Microsoft Visual Studio 8\VC\vcvarsall.bat"</pre><p class="startli">On my computer, this sets the environment variables so that I can use the MSVC++ compiler.</p>
<p class="startli">If you want to use also a native Fortran compiler, you need to include something like this </p><pre class="fragment">call "C:\Program Files\Intel\Fortran\compiler80\IA32\BIN\ifortvars.bat"</pre><p class="startli">You might have to search around a bit. The important thing is that, after your change, you can type <code>cl</code> in a newly opened Cygwin windows, and it finds the Microsoft C++ compiler (and if you want to use it, the Fortran compiler, such as the Intel's <code>ifort</code>).</p>
</li>
<li><p class="startli">Run the configuration script, and tell it that you want to use the native compilers: </p><pre class="fragment">./configure –enable-doscompile=msvc</pre><p class="startli">Make sure the last message is <code>Main <a class="el" href="namespaceIpopt.html" title="This file contains a base class for all exceptions and a set of macros to help with exceptions...">Ipopt</a> configuration successful</code>.</p>
</li>
<li>Now you can compile the code with <pre class="fragment">make</pre> test the installation with <pre class="fragment">make test</pre> and install everything with <pre class="fragment">make install</pre></li>
</ol>
<h2><a class="anchor" id="INSTALL_MINGW"></a>
Installation with MSYS/MinGW</h2>
<p>You can compile <code>Ipopt</code> also under MSYS/MinGW, which is another, more light-weight UNIX-like environment for Windows. It can be obtained from <a href="http://www.mingw.org/">http://www.mingw.org/</a>.</p>
<p>If you want to use MSYS/MinGW to compile <code>Ipopt</code> with native Windows compilers (see <a class="el" href="INSTALL.html#INSTALL_CYGWINNATIVE">Installation with Cygwin using the MSVC++ compiler</a>), all you need to install is the basic version (a convenient Windows install program is available from <a href="http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/">http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/</a>). If you also want to use the GNU compilers, you need to install those as well, of course.</p>
<p>A compilation with the GNU compilers works just like with any other UNIX system, as described in <a class="el" href="INSTALL.html#COMPILEINSTALL">Compiling and Installing Ipopt</a>. That is, during the installation, select (at least) the C Compiler, C++ Compiler, Fortran Compiler, MSYS Basic System, and the MinGW Developer ToolKit. Additionally, wget and unzip should be installed with the following command in an MSYS terminal: </p><pre class="fragment">mingw-get install msys-wget msys-unzip
</pre><p>If you want to use the native MSVC++ compiler (with <code>f2c</code> or a native Fortran compiler), you essentially follow the steps outlined in <a class="el" href="INSTALL.html#INSTALL_CYGWINNATIVE">Installation with Cygwin using the MSVC++ compiler</a>. Additionally, you need to make sure that the environment variables are set for the compilers (see step 2), this time adding the line to the msys.bat file.</p>
<p>For a 64-bit build, you will need to install also a MinGW-64 distribution. We recommend TDM-GCC, which is available from <a href="http://sourceforge.net/projects/tdm-gcc/files/TDM-GCC%20Installer/tdm-gcc-webdl.exe/download">http://sourceforge.net/projects/tdm-gcc/files/TDM-GCC%20Installer/tdm-gcc-webdl.exe/download</a>. Install MinGW-64 in a different folder than your existing 32-bit MinGW installation! The components you need are: core (under gcc), c++ (under gcc), fortran (under gcc), openmp (under gcc, necessary if you want to use any multi-threaded linear solvers), binutils, and mingw64-runtime.</p>
<p>After MinGW-64 is installed, open the file <code>C:\MinGW\msys\1.0\etc\fstab</code>, and replace the line </p><pre class="fragment">C:\MinGW\     /mingw
</pre><p> with </p><pre class="fragment">C:\MinGW64\   /mingw
</pre><p>(Replace paths with your installation locations if different.)</p>
<h1><a class="anchor" id="INSTALL_JAVA"></a>
Compiling and Installing the Java Interface JIpopt</h1>
<p>based on documentation by Rafael de Pelegrini Soares* (VRTech Industrial Technologies)</p>
<p><code>JIpopt</code> uses the Java Native Interface (JNI), which is a programming framework that allows Java code running in the Java Virtual Machine (JVM) to call and be called by native applications and libraries written in languages such as C and C++. <code>JIpopt</code> requires Java 5 or higher.</p>
<p>After building and installing <code>Ipopt</code>, the <code>JIpopt</code> interface can be build by setting the environment variable <code>JAVA_HOME</code> to the directory that contains your JDK, changing to the <code>JIpopt</code> directory in your <code>Ipopt</code> build, and issuing make, e.g., </p><pre class="fragment">export JAVA_HOME=/usr/lib/jvm/java-1.5.0
cd $IPOPTDIR/build/Ipopt/contrib/JavaInterface
make
</pre><p>This will generate the Java class org/coinor/Ipopt.class, which you will need to make available in your Java code (i.e., add <code>$IPOPTDIR/build/Ipopt/contrib/JavaInterface</code> to your <code>CLASSPATH</code>) and the shared object <code>lib/libjipopt.so</code> (on Linux/UNIX) or <code>lib/libjipopt.dylib</code> (on Mac OS X) or the DLL <code>lib/jipopt.dll</code> (on Windows). In order to test your <code>JIpopt</code> library you can run two example problems by issuing the command <code>make test</code> inside the <code>JIpopt</code> directory.</p>
<dl class="section note"><dt>Note</dt><dd>The <code>JIpopt</code> build procedure currently cannot deal with spaces in the path to the JDK. If you are on Windows and have Java in a path like <code>C:\Program Files\Java</code>, try setting <code>JAVA_HOME</code> to the DOS equivalent <code>C:\Progra~1\Java</code> (or similar).</dd>
<dd>
<code>JIpopt</code> needs to be able to load the <code>Ipopt</code> library dynamically at runtime. Therefore, <code>Ipopt</code> must have been compiled with the <code>-fPIC</code> compiler flag. While per default, an <a class="el" href="namespaceIpopt.html" title="This file contains a base class for all exceptions and a set of macros to help with exceptions...">Ipopt</a> shared library is compiled with this flag, for a configuration of <code>Ipopt</code> in debug mode (<code>--enable-debug</code>) or as static library (<code>--disable-shared</code>), the configure flag <code>--with-pic</code> need to be used to enable compilation with <code>-fPIC</code>.</dd></dl>
<h1><a class="anchor" id="INSTALL_R"></a>
Compiling and Installing the R Interface ipoptr</h1>
<p>The <code>ipoptr</code> interface can be build after <code>Ipopt</code> has been build and installed. In the best case, it is sufficient to execute the following command in R: </p><pre class="fragment">install.packages('$IPOPTDIR/build/Ipopt/contrib/RInterface', repos=NULL, type='source')
</pre><p>In certain situations, however, it can be necessary to setup the dynamic library load path to the path where the <code>Ipopt</code> library has been installed, e.g., </p><pre class="fragment">LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$IPOPTDIR/build/lib
</pre><dl class="section note"><dt>Note</dt><dd>R needs to be able to load the <code>Ipopt</code> library dynamically at runtime. Therefore, <code>Ipopt</code> must have been compiled with the <code>-fPIC</code> compiler flag. While per default, an <a class="el" href="namespaceIpopt.html" title="This file contains a base class for all exceptions and a set of macros to help with exceptions...">Ipopt</a> shared library is compiled with this flag, for a configuration of <code>Ipopt</code> in debug mode (<code>--enable-debug</code>) or as static library (<code>--disable-shared</code>), the configure flag <code>--with-pic</code> need to be used to enable compilation with <code>-fPIC</code>.</dd></dl>
<p>After installation of the <code>ipoptr</code> package, it should be possible to load the package in R and to view the help page: </p><pre class="fragment">library('ipoptr')
?ipoptr
</pre><h1><a class="anchor" id="INSTALL_MATLAB"></a>
Compiling and Installing the MATLAB interface</h1>
<p>based on documentation by Peter Carbonetto (University of British Columbia), Tony Kelman (then University of California, Berkeley), and Ray Zimmerman*</p>
<p>The MATLAB interface to <code>Ipopt</code> uses the mex interface of MATLAB. It has been tested on MATLAB versions 7.2 through 7.7. It might very well work on earlier versions of MATLAB, but there is also a good chance that it will not. It is unlikely that the software will run with versions prior to MATLAB 6.5.</p>
<dl class="section note"><dt>Note</dt><dd>The MATLAB interface <b>does not support MATLAB 8.3</b> (aka, R2014a), as it has not been adapted to MATLAB changes in the buildsystem for MEX files.</dd></dl>
<p>First, note that some binaries of <code>Ipopt</code> mex files are available for download at <a href="http://www.coin-or.org/download/binary/Ipopt">http://www.coin-or.org/download/binary/Ipopt</a>. Further, the <a href="http://www.i2c2.aut.ac.nz/Wiki/OPTI">OPTI Toolbox</a> comes with a precompiled MATLAB interface for <code>Ipopt</code> on Windows.</p>
<h2><a class="anchor" id="INSTALL_MATLAB_MEX"></a>
Setting up mex</h2>
<p>To build the interface by yourself, you will need to have MATLAB installed on your system and have it configured to build mex files, see <a href="http://www.mathworks.com/support/tech-notes/1600/1605.html">http://www.mathworks.com/support/tech-notes/1600/1605.html</a> for detail on how to set this up.</p>
<p><code>Ipopt</code> 3.11 has added Makefile options to automate fixes for commonly-encountered issues with building the MATLAB interface. On Mac OS X or Windows, the file <code>mexopts.sh</code> (<code>mexopts.bat</code> on Windows) will need to be modified. This is performed automatically by calling <code>make mexopts</code> in the <code>$IPOPTDIR/build/Ipopt/contrib/MatlabInterface/src</code> directory. No changes will be made if you already have a <code>mexopts.sh</code> file in that directory. If you need to make these modifications manually, follow the steps below.</p>
<p>For Mac OS X, the following procedure has been reported: First, one executes a command like </p><pre class="fragment">/Applications/MATLAB_R2012.app/bin/mex -setup
</pre><p>This creates a <code>mexopts.sh</code> file in the <code>~/.matlab/R2010</code> directory. Copy that file to the directory <code>$IPOPTDIR/build/Ipopt/contrib/MatlabInterface/src</code> and modify it as follows.</p>
<ul>
<li>In the <code>maci</code> section (32 bit builds) or the <code>maci64</code> section (64 bit builds), change both instances of <code>libgfortran.dylib</code> to <code>libgfortran.a</code> in the <code>FC_LIBDIR</code> line (in case your Fortran compiler only comes with static libraries).</li>
<li>Remove all occurrences of <code>-isysroot $SDKROOT</code> or <code>-Wl,-syslibroot,$SDKROOT</code> in case the hard-coded version of the Xcode SDK that Matlab expects does not match what you have installed on your system.</li>
<li>Remove all occurrences of <code>-arch $ARCHS</code> in case you are using a GNU compiler that does not recognize these Apple-specific flags.</li>
</ul>
<p>On Windows, if you are using the GNU compilers via MinGW, then you will need to use the gnumex project. First, execute the script <code>./get.Gnumex</code> from the <code>$IPOPTDIR/Ipopt/contrib/MatlabInterface</code> directory. Then, after configuring <code>Ipopt</code>, go to <code>$IPOPTDIR/build/contrib/MatlabInterface/src</code> and execute <code>make gnumex</code>. This will start an instance of MATLAB and open the gnumex tool. Check that the options are filled out appropriately for your MinGW installation, click "Make options file," then close this new instance of MATLAB after gnumex has created <code>mexopts.bat</code>.</p>
<p>Calling <code>make mexopts</code> will automatically make the necessary changes to this new <code>mexopts.bat</code> file. If you would like to do so manually, the changes are as follows.</p>
<ul>
<li>Change <code>COMPILER=gcc</code> to <code>COMPILER=g++</code></li>
<li>Change <code>GM_MEXLANG=c</code> to <code>GM_MEXLANG=cxx</code></li>
<li>Add the contents of the <code>LIBS=</code> line from the MATLAB interface Makefile to <code>GM_ADD_LIBS</code></li>
<li>If you want to statically link the standard libraries into the mex file, add <code>-static</code> to <code>GM_ADD_LIBS</code></li>
</ul>
<h2><a class="anchor" id="INSTALL_MATLAB_IPOPT"></a>
Adjusting configuration and build of Ipopt</h2>
<p>The configure script of <code>Ipopt</code> attempts to automatically locate the directory where MATLAB is installed by querying the location of the matlab executable. You can also manually specify the MATLAB home directory when calling the configure script with the flag <code>--with-matlab-home</code>. You can determine this home directory by the command <code>matlabroot</code> within MATLAB.</p>
<p>In practice, it has been found easier to install and use the MATLAB interface by disabling compilation of the shared libraries, and use only static libraries instead. However, these static libraries need to be built in a way that allow using them in a shared library, i.e., they need to build with position-independent code. This is achieved with the configure script flags <code>--disable-shared --with-pic</code>.</p>
<p>On Mac OS X, it has been reported that additionally the following flags for configure should be used: </p><pre class="fragment">ADD_CFLAGS="-fno-common -fexceptions -no-cpp-precomp"
ADD_CXXFLAGS="-fno-common -fexceptions -no-cpp-precomp"
ADD_FFLAGS="-fexceptions -fbackslash"
</pre><p>With <code>Ipopt</code> 3.11, a <em>site script for configure</em> has been added to the MATLAB interface. This script takes care of setting configure options in a way that is appropriate for building an <code>Ipopt</code> mex file that is useable via MATLAB. Therefore, instead of setting configure options as described in the previous section, it should be sufficient to create a directory <code>$IPOPTDIR/build/share</code>, copy the site file <code>$IPOPTDIR/contrib/MatlabInterface/MatlabInterface.site</code> to that directory, and rename it to <code>config.site</code> before running configure. Alternatively, you can set an environment variable <code>CONFIG_SITE</code> that points to the site file.</p>
<p>This site script sets the configure flags (if not specified by the user) <code>--disable-shared --with-pic --with-blas=BUILD --with-lapack=BUILD</code>. The first two flags are discussed above. We also specify that the reference versions of BLAS and LAPACK should be used by default because of a commonly observed issue on 64-bit Linux systems. If <code>Ipopt</code> configure finds BLAS and/or LAPACK libraries already installed then it will use them. However, MATLAB includes its own versions of BLAS and LAPACK, which on 64-bit systems are incompatible with the expected interface used by <code>Ipopt</code> and the BLAS and LAPACK packages available in many Linux distributions. If the <code>Ipopt</code> mex file is compiled in such a way that the BLAS and LAPACK libraries are dynamically linked as shared libraries (as found in installed Linux packages), those library dependencies will be overridden by MATLAB's incompatible versions. This can be avoided by statically linking BLAS and LAPACK into the <code>Ipopt</code> mex file, which the above combination of configure flags will do. Note, that this issue does not appear to affect Mac OS X versions of MATLAB, so if you would like to use the Apple optimized BLAS and LAPACK libraries you can override these settings and specify `&ndash;with-blas='-framework vecLib' &ndash;with-lapack='-framework vecLib'`.</p>
<p>The site script also tests whether the compilers on your system are capable of statically linking the standard C++ and Fortran libraries into a shared library. This is possible with GCC versions 4.5.0 or newer on Mac OS X or Windows, 4.7.3 or newer (when GCC itself is built <code>--with-pic</code>) on Linux. If this is the case, then the site script will set appropriate configure flags and options in the MATLAB interface Makefile to statically link all standard libraries into the <code>Ipopt</code> mex file. This should allow a single mex file to work with a variety of versions of MATLAB, and on computers that do not have the same compiler versions installed. If this static linking of standard libraries causes any issues, you can disable it with the configure flag &ndash;disable-matlab-static.</p>
<h2><a class="anchor" id="INSTALL_MATLAB_BUILD"></a>
Building the MATLAB interface</h2>
<p>After configuring, building, and installing <code>Ipopt</code> itself, it is time to build the MATLAB interface. For that, <code>Ipopt</code>'s configure has setup a directory <code>$IPOPTDIR/build/contrib/MatlabInterface/src</code> which contains a Makefile. You may need to edit this file a little bit to suit for your system setup. You will find that most of the variables such as <code>CXX</code> and <code>CXXFLAGS</code> have been automatically (and hopefully, correctly) set according to the flags specified during your initial call to configure script. However, you may need to modify <code>MATLAB_HOME</code>, <code>MEXSUFFIX</code> and <code>MEX</code> as explained in the comments of the Makefile. For example, on Mac OS X, it has been reported that all duplicates of strings like <code>-L/usr/lib/gcc/i686-apple-darwin11/4.2.1/../../..</code> should be removed from the <code>LIBS</code> line.</p>
<p>Once you think you've set up the Makefile properly, type <code>make install</code> in the same directory as the Makefile. If you didn't get any errors, then you should have ended up with a mex file. The mex file will be called <code>ipopt.$MEXEXT</code>, where <code>$MEXEXT</code> is <code>mexglx</code> for 32-bit Linux, <code>mexa64</code> for 64-bit Linux, <code>mexw32</code> for 32-bit Windows, etc.</p>
<h2><a class="anchor" id="INSTALL_MATLAB_ADDPATH"></a>
Making MATLAB aware of the mex file</h2>
<p>In order to use the mex file in MATLAB, you need to tell MATLAB where to find it. The best way to do this is to type </p><pre class="fragment">addpath &lt;sourcedir&gt;
</pre><p> in the MATLAB command prompt, where <code>&lt;sourcedir&gt;</code> is the location of the mex file you created. (For more information, type <code>help addpath</code> in MATLAB. You can also achieve the same thing by modifying the <code>MATLABPATH</code> environment variable in the UNIX command line, using either the <code>export</code> command (in Bash shell) or the <code>setenv</code> command (in C-shell).</p>
<h2><a class="anchor" id="INSTALL_MATLAB_NOTES"></a>
Additional notes</h2>
<p>Starting with version 7.3, MATLAB can handle 64-bit addressing, and the authors of MATLAB have modified the implementation of sparse matrices to reflect this change. However, the row and column indices in the sparse matrix are converted to signed integers, and this could potentially cause problems when dealing with large, sparse matrices on 64-bit platforms with MATLAB version 7.3 or greater.</p>
<p>As MATLAB (version R2008a or newer) includes its own HSL MA57 library, <code>Ipopt</code>'s configure can be setup to enable using this library in <code>Ipopt</code>'s MA57 solver interface. To enable this, one should specify the configure option <code>--enable-matlab-ma57</code>. Note, that using this option is not advisable if one also provides the source for MA57 via ThirdParty/HSL.</p>
<h2><a class="anchor" id="INSTALL_MATLAB_TROUBLESHOOT"></a>
Troubleshooting</h2>
<p>The installation procedure described above does involve a certain amount of expertise on the part of the user. If you are encountering problems, it is highly recommended that you follow the standard installation of <code>Ipopt</code> first, and then test the installation by running some examples, either in C++ or in AMPL.</p>
<p>What follows are a list of common errors encountered, along with a suggested remedy.</p>
<ul>
<li><p class="startli"><b>Problem:</b> compilation is successful, but MATLAB crashes</p>
<p class="startli"><b>Remedy:</b> Even if you didn't get any errors during compilation, there's still a possibility that you didn't link the mex file properly. In this case, executing <code>Ipopt</code> in MATLAB will cause MATLAB to crash. This is a common problem, and usually arises because you did not choose the proper compiler or set the proper compilation flags (e.g. <code>--with-pic</code>) when you ran the configure script at the very beginning.</p>
</li>
<li><p class="startli"><b>Problem:</b> MATLAB fails to link to <code>Ipopt</code> shared library</p>
<p class="startli"><b>Remedy:</b> You might encounter this problem if you try to execute one of the examples in MATLAB, and MATLAB complains that it cannot find the <code>Ipopt</code> shared library. The installation script has been set up so that the mex file you are calling knows where to look for the <code>Ipopt</code> shared library. However, if you moved the library then you will run into a problem. One way to fix this problem is to modify the <code>LDFLAGS</code> variable in the MATLAB interface Makefile (see above) so that the correct path of the <code>Ipopt</code> library is specified. Alternatively, you could modify the <code>LD_LIBRARY_PATH</code> environment variable so that the location of the <code>Ipopt</code> library is included in the path. If none of this is familiar to you, you might want to do a web search to find out more.</p>
</li>
<li><p class="startli"><b>Problem:</b> <code>mwIndex</code> is not defined</p>
<p class="startli"><b>Remedy:</b> You may get a compilation error that says something to the effect that <code>mwIndex</code> is not defined. This error will surface on a version of MATLAB prior to 7.3. The solution is to add the flag <code>-DMWINDEXISINT</code> to the <code>CXXFLAGS</code> variable in the MATLAB interface Makefile (see above).</p>
</li>
</ul>
<h1><a class="anchor" id="EXPERT_INSTALL"></a>
Expert Installation Options for Ipopt</h1>
<p>The configuration script and Makefiles in the <code>Ipopt</code> distribution have been created using GNU's autoconf and automake. They attempt to automatically adapt the compiler settings, etc., to the system they are running on. We tested the provided scripts for a number of different machines, operating systems and compilers, but you might run into a situation where the default setting does not work, or where you need to change the settings to fit your particular environment.</p>
<p>In general, you can see the list of options and variables that can be set for the configure script by typing <code>configure --help</code>. Also, the <a href="https://projects.coin-or.org/CoinHelp">generic COIN-OR help pages</a> are a valuable resource of information.</p>
<p>Below a few particular options are discussed:</p>
<ul>
<li><p class="startli">The configure script tries to determine automatically, if you have BLAS and/or LAPACK already installed on your system (trying a few default libraries), and if it does not find them, it makes sure that you put the source code in the required place.</p>
<p class="startli">However, you can specify a BLAS library (such as your local <a href="http://math-atlas.sourceforge.net">ATLAS library</a>) explicitly, using the <code>--with-blas</code> flag for configure. For example, </p><pre class="fragment">./configure --with-blas="-L$HOME/lib -lf77blas -lcblas -latlas"</pre><p class="startli">To tell the configure script to compile and use the downloaded BLAS source files even if a BLAS library is found on your system, specify <code>--with-blas=BUILD</code>.</p>
<p class="startli">Similarly, you can use the <code>--with-lapack</code> switch to specify the location of your LAPACK library, or use the keyword <code>BUILD</code> to force the <code>Ipopt</code> makefiles to compile LAPACK together with <code>Ipopt</code>.</p>
</li>
<li>Similarly, if you have a precompiled library containing the HSL packages, you can specify the directory with the <code>CoinHslConfig.h</code> header file with the <code>--with-hsl-incdir</code> flag and the linker flags with the <code>--with-hsl-lib</code> flag. Analogously, use <code>--with-asl-incdir</code> and <code>--with-asl-lib</code> for building against a precompiled AMPL solver library.</li>
<li>The HSL codes <code>HSL_MA86</code> and <code>HSL_MA97</code> can run in parallel if compiled with OpenMP support. By default, this is not enabled by <code>Ipopt</code>'s configure so far. To enable OpenMP with GNU compilers, it has been reported that the following configure flags should be used: <pre class="fragment">ADD_CFLAGS=-fopenmp ADD_FFLAGS=-fopenmp ADD_CXXFLAGS=-fopenmp</pre></li>
<li><p class="startli">If you want to compile <code>Ipopt</code> with the linear solver Pardiso (see <a class="el" href="INSTALL.html#DOWNLOAD_PARDISO">Obtaining the Linear Solver Pardiso</a>) from the Pardiso project website, you need to specify the link flags for the library with the <code>--with-pardiso</code> flag, including required additional libraries and flags. For example, if you want to compile <code>Ipopt</code> with the parallel version of Pardiso (located in <code>$HOME/lib</code>) on an AIX system in 64bit mode, you should add the flag </p><pre class="fragment">--with-pardiso="-qsmp=omp $HOME/lib/libpardiso_P4AIX51_64_P.so"</pre><p class="startli">If you are using the parallel version of Pardiso, you need to specify the number of processors it should run on with the environment variable <code>OMP_NUM_THREADS</code>, as described in the Pardiso manual.</p>
<p class="startli">If you want to compile <code>Ipopt</code> with the Pardiso library that is included in Intel MKL, it should be sufficient to ensure that MKL is used for the linear algebra routines (Blas/Lapack). On some systems, configure is able to find MKL automatically when looking for Blas. On other systems, one has to specify the MKL libraries with the <code>--with-blas</code> option.</p>
<p class="startli">For best performance on Linux, use Pardiso from the Pardiso project website together with linear algebra from Intel MKL. The configure command would be something like the following (all in one line): </p><pre class="fragment">MKL_LIBS="-L${MKLROOT}/lib/intel64 -Wl,--no-as-needed -lmkl_intel_lp64 -lmkl_lapack95_lp64 -lmkl_sequential -lmkl_core -lgfortran -fopenmp -lpthread -lm -ldl"
ADD_CFLAGS="-fopenmp -fno-common -fexceptions"
ADD_CXXFLAGS="-fopenmp -fno-common -fexceptions"
ADD_FFLAGS="-fopenmp -fexceptions"
./configure -C F77=gfortran CC=gcc CXX=g++ --with-blas-lib="${MKL_LIBS}" --with-lapack-lib="${MKL_LIBS}" --with-pardiso="libpardiso600-GNU720-X86-64.so -lgfortran -lquadmath"</pre></li>
<li>If you want to compile <code>Ipopt</code> with the linear solver WSMP (see <a class="el" href="INSTALL.html#DOWNLOAD_WSMP">Obtaining the Linear Solver WSMP</a>), you need to specify the link flags for the library with the <code>--with-wsmp</code> flag, including required additional libraries and flags. For example, if you want to compile <code>Ipopt</code> with WSMP (located in <code>$HOME/lib</code>) on an Intel IA32 Linux system, you should add the flag <pre class="fragment">--with-wsmp="$HOME/lib/wsmp/wsmp-Linux/lib/IA32/libwsmp.a -lpthread"</pre></li>
<li>If you want to compile <code>Ipopt</code> with a precompiled MUMPS library (see <a class="el" href="INSTALL.html#DOWNLOAD_MUMPS">Obtaining the MUMPS Linear Solver</a>), you need to specify the directory containing the MUMPS header files with the <code>--with-mumps-incdir</code> flag, e.g., <pre class="fragment">--with-mumps-incdir="$HOME/MUMPS/include"</pre> and you also need to provide the link flags for MUMPS with the <code>--with-mumps-lib</code> flag.</li>
<li><p class="startli">If you want to specify that you want to use particular compilers, you can do so by adding the variables definitions for CXX, CC, and F77 to the <code>./configure</code> command line, to specify the C++, C, and Fortran compiler, respectively. For example, </p><pre class="fragment">./configure CXX=g++-4.2.0 CC=gcc-4.2.0 F77=gfortran-4.2.0</pre><p class="startli">In order to set the compiler flags, you should use the variables <code>CXXFLAGS</code>, <code>CFLAGS</code>, <code>FFLAGS</code>. Note, that the <code>Ipopt</code> code uses <code>dynamic_cast</code>. Therefore it is necessary that the C++ code is compiled including RTTI (Run-Time Type Information). Some compilers need to be given special flags to do that (e.g., <code>-qrtti=dyna</code> for the AIX <code>xlC</code> compiler).</p>
<p class="startli">Please also check the <a href="https://projects.coin-or.org/CoinHelp/wiki/user-configure#GivingOptions">generic COIN-OR help page</a> for the description of more variables that can be set for configure.</p>
</li>
<li>By default, the <code>Ipopt</code> library is compiled as a shared library, on systems where this is supported. If you want to generate a static library, you need to specify the <code>--disable-shared</code> flag. If you want to compile both shared and static libraries, you should specify the <code>--enable-static</code> flag.</li>
<li><p class="startli">If you want to link the <code>Ipopt</code> library with a main program written in C or Fortran, the C and Fortran compiler doing the linking of the executable needs to be told about the C++ runtime libraries. Unfortunately, the current version of autoconf does not provide the automatic detection of those libraries. We have hard-coded some default values for some systems and compilers, but this might not work all the time.</p>
<p class="startli">If you have problems linking your Fortran or C code with the <code>Ipopt</code> library libipopt.a and the linker complains about missing symbols from C++ (e.g., the standard template library), you should specify the C++ libraries with the <code>CXXLIBS</code> variable. To find out what those libraries are, it is probably helpful to link a simple C++ program with verbose compiler output.</p>
<p class="startli">For example, for the Intel compilers on a Linux system, you might need to specify something like </p><pre class="fragment">./configure CC=icc F77=ifort CXX=icpc CXXLIBS='-L/usr/lib/gcc-lib/i386-redhat-linux/3.2.3 -lstdc++'</pre></li>
<li>Compilation in 64bit mode sometimes requires some special consideration. For example, for compilation of 64bit code on AIX, we recommend the following configuration <pre class="fragment">./configure AR='ar -X64' NM='nm -X64' CC='xlc -q64' F77='xlf -q64' CXX='xlC -q64' CFLAGS='-O3 -bmaxdata:0x3f0000000' FFLAGS='-O3 -bmaxdata:0x3f0000000' CXXFLAGS='-qrtti=dyna -O3 -bmaxdata:0x3f0000000'</pre> (Alternatively, a simpler solution for AIX is to set the environment variable <code>OBJECT_MODE</code> to 64.)</li>
<li><p class="startli">It is possible to compile the <code>Ipopt</code> library in a debug configuration, by specifying <code>--enable-debug</code>. Then the compilers will use the debug flags (unless the compilation flag variables are overwritten in the configure command line)</p>
<p class="startli">Also, you can tell <code>Ipopt</code> to do some additional runtime sanity checks, by specifying the flag <code>--with-ipopt-checklevel=1</code>.</p>
<p class="startli">This usually leads to a significant slowdown of the code, but might be helpful when debugging something. </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
